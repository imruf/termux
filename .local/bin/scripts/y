#!/bin/sh

## youtube-dl script to download and stream media url in termux

while getopts "adfhiu:r:" o; do case "${o}" in
        h)  printf "Options\\n -u: URL\\n -r: Resolution\\n -a: Audio Stream In Termux With mpv\\n -i: Insert hls Code\\n -f: Get Code\\n -d: Download\\n -h: Help\\n" && exit 1 ;;
        u) URL="${OPTARG}" ;;
        r) RES="${OPTARG}" ;;
        a) [ -z $URL ] && read -p "URL: " URL
           read -p "a/b/c/d/e/?: " RES
           RES="$(printf $RES | sed 's/a/249/;s/b/250/;s/c/251/;s/d/139/;s/e/140/')"
           MPVYT="${MPVYT-mpv $(youtube-dl -f $RES -g "$URL")}" ;;
        d) [ -z $URL ] && read -p "URL: " URL
           youtube-dl -F "$URL"
           read -p "Code: " RES
           MPVYT="${MPVYT-youtube-dl -f $RES "$URL"}" ;;
        f) [ -z $URL ] && read -p "URL: " URL
           youtube-dl -F "$URL"
           read -p "Code: " RES
           MPVYT="${MPVYT-xdg-open $(youtube-dl -f $RES -g "$URL")}" ;;
        i) [ -z $URL ] && read -p "URL: " URL
           read -p "a/b/c/d/?: " RES
           RES="$(printf $RES | sed 's/a/hls-250p/;s/b/hls-360p/;s/c/hls-480p/;s/d/hls-720p/')"
           MPVYT="${MPVYT-xdg-open $(youtube-dl -f $RES -g "$URL")}" ;;
esac done

[ -z $URL ] && read -p "URL: " URL
[ -z $RES ] && read -p "l/m/s/k/?: " RES
RES="$(printf $RES | sed 's/l/240/;s/m/360/;s/s/480/;s/h/720/;s/k/1080/')"
YTF="bestvideo[height<=$RES]+bestaudio/best[height<=$RES]"
MPVYT="${MPVYT-xdg-open $(youtube-dl -f $YTF -g "$URL")}"

$MPVYT
